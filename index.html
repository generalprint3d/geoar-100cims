<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>GeoAR WMS Test</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet/dist/leaflet.css"
/>

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: black;
}

/* ğŸ“· cÃ mera */
#camera {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
}

/* ğŸ—ºï¸ mapa */
#map {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  background: transparent;
}

/* ğŸšï¸ slider */
#controls {
  position: fixed;
  bottom: 20px;
  left: 20px;
  right: 20px;
  z-index: 999;
  background: rgba(0,0,0,0.5);
  padding: 10px;
  border-radius: 10px;
  color: white;
  font-family: sans-serif;
}
</style>
</head>

<body>

<video id="camera" autoplay playsinline muted></video>
<div id="map"></div>

<div id="controls">
TransparÃ¨ncia:
<input type="range" id="opacity" min="0" max="1" step="0.05" value="0.7">
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
// ğŸ“· activar cÃ mera
navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
.then(stream => {
  document.getElementById("camera").srcObject = stream;
})
.catch(err => {
  alert("Error cÃ mera: " + err);
});

// ğŸ—ºï¸ mapa Leaflet
var map = L.map('map', {
  zoomControl: true,
  attributionControl: false
}).setView([42.13, 1.78], 13); // â† desprÃ©s ho farem dinÃ mic

// ğŸŒ WMS Instamaps
var wmsLayer = L.tileLayer.wms(
  "https://www.instamaps.cat/geoservicelocal/18288789/fb875761598049764f9a7a8d5fe20100",
  {
    layers: "Capa_cc34f6c44dd752e48d7dc74a3886a695",
    format: "image/png",
    transparent: true,
    opacity: 0.7,
    version: "1.3.0"
  }
).addTo(map);

// ğŸšï¸ slider transparÃ¨ncia
document.getElementById("opacity").addEventListener("input", function(e) {
  wmsLayer.setOpacity(e.target.value);
});
</script>

</body>
</html>